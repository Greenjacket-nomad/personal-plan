<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>Error - Curriculum Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/design-system.css">
    <link rel="stylesheet" href="/static/style.css">
    <style>
        /* Error Page - Personality-filled Design */
        .error-illustration-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: var(--spacing-xl);
        }
        
        .error-illustration {
            font-size: 8rem;
            color: var(--accent);
            opacity: 0.8;
            margin-bottom: var(--spacing-md);
            animation: float 3s ease-in-out infinite;
        }
        
        .error-illustration-subtitle {
            font-size: var(--text-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: var(--letter-spacing-wide);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .error-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-xl);
            text-align: center;
        }
        
        .error-content {
            max-width: 600px;
        }
        
        .error-title {
            font-size: var(--text-3xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
        }
        
        .error-message {
            font-size: var(--text-lg);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-xl);
            line-height: var(--line-height-relaxed);
        }
        
        .error-actions {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            align-items: center;
        }
        
        @media (min-width: 640px) {
            .error-actions {
                flex-direction: row;
                justify-content: center;
            }
        }
        
        .error-technical {
            margin-top: var(--spacing-2xl);
            padding: var(--spacing-lg);
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            text-align: left;
        }
        
        .error-technical summary {
            cursor: pointer;
            font-weight: var(--font-weight-semibold);
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
        }
        
        .error-technical pre {
            background: var(--bg-secondary);
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            overflow-x: auto;
            font-size: var(--text-xs);
            color: var(--text-secondary);
        }
        
        .header {
            background: var(--bg-secondary);
            border-bottom: 2px solid var(--accent);
            transition: all 0.3s ease;
        }
        
        [data-theme="dark"] .header {
            background: linear-gradient(135deg, rgba(15, 15, 15, 0.95) 0%, rgba(26, 26, 26, 0.95) 100%);
        }
        
        .header a.text-2xl:hover {
            transform: scale(1.05);
            transition: transform 150ms ease;
        }
    </style>
    <script>
        (function() {
            const saved = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = saved || (prefersDark ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <script src="/static/js/accessibility.js"></script>
</head>
    <body class="min-h-screen">
    <a href="#main-content" id="skip-to-main" class="skip-to-main">Skip to main content</a>
    <header class="header py-6 px-8">
        <div class="max-w-7xl mx-auto">
            <!-- Unified Navigation -->
            <div class="flex items-center justify-between">
                <!-- Left: Logo + Breadcrumbs -->
                <div class="flex items-center gap-6">
                    <a href="/" class="text-2xl font-bold text-primary hover:text-accent transition-all" title="Dashboard">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span class="hidden md:inline">Curriculum Tracker</span>
                    </a>
                </div>
                
                <!-- Right: Navigation + Utilities -->
                <div class="flex items-center gap-6">
                    <!-- Main Navigation -->
                    <nav class="hidden md:flex items-center gap-4">
                        <a href="/" class="nav-item">Dashboard</a>
                        <a href="/resources" class="nav-item">Curriculum</a>
                        <a href="/journal" class="nav-item">Journal</a>
                        <a href="/reports" class="nav-item">Reports</a>
                        <a href="/activity" class="nav-item">Activity</a>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    
    <div class="error-container">
        <div class="error-content">
            <div class="card p-8">
                <!-- Error Illustration -->
                {% set error_type = '404' if error and ('404' in error|string or 'Not Found' in error|string) else ('500' if error and ('500' in error|string or 'Internal' in error|string) else ('403' if error and ('403' in error|string or 'Forbidden' in error|string) else 'generic')) %}
                
                {% if error_type == '404' %}
                <div class="error-illustration-wrapper mb-6">
                    <div class="error-illustration">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <div class="error-illustration-subtitle">Explorer Mode</div>
                </div>
                <h1 class="text-4xl font-bold mb-4 text-primary">Looks like this page went on a learning break</h1>
                <p class="text-xl text-secondary mb-2">
                    We couldn't find the page you're looking for. It might have moved or doesn't exist yet.
                </p>
                {% elif error_type == '500' %}
                <div class="error-illustration-wrapper mb-6">
                    <div class="error-illustration">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="error-illustration-subtitle">Maintenance Mode</div>
                </div>
                <h1 class="text-4xl font-bold mb-4 text-primary">We're fixing things behind the scenes</h1>
                <p class="text-xl text-secondary mb-2">
                    We encountered an unexpected error on our end. Our team has been notified and is working on it.
                </p>
                {% elif error_type == '403' %}
                <div class="error-illustration-wrapper mb-6">
                    <div class="error-illustration">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="error-illustration-subtitle">Access Restricted</div>
                </div>
                <h1 class="text-4xl font-bold mb-4 text-primary">This area is off-limits</h1>
                <p class="text-xl text-secondary mb-2">
                    You don't have permission to access this page. If you believe this is an error, please contact support.
                </p>
                {% else %}
                <div class="error-illustration-wrapper mb-6">
                    <div class="error-illustration">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="error-illustration-subtitle">Something Went Wrong</div>
                </div>
                <h1 class="text-4xl font-bold mb-4 text-primary">Oops! Something unexpected happened</h1>
                <p class="text-xl text-secondary mb-2">
                    {% if error %}{{ error }}{% else %}We encountered an unexpected error.{% endif %}
                </p>
                {% endif %}
                
                <p class="text-muted mb-8">
                    Don't worry - your data is safe. Try one of the options below to get back on track.
                </p>
            </div>
            
            <div class="error-actions">
                <a href="/" class="btn-primary">
                    <i class="fas fa-home mr-2"></i>Return to Dashboard
                </a>
                <button onclick="goBack()" class="btn-secondary">
                    <i class="fas fa-arrow-left mr-2"></i>Go Back
                </button>
                <button onclick="window.location.reload()" class="btn-secondary">
                    <i class="fas fa-redo mr-2"></i>Try Again
                </button>
            </div>
            
            <details class="error-technical">
                <summary>Technical Details</summary>
                <pre>{% if error %}{{ error }}{% else %}No additional error information available.{% endif %}</pre>
                <button onclick="copyErrorDetails()" class="btn-secondary btn-sm mt-2">
                    <i class="fas fa-copy mr-1"></i>Copy Error Details
                </button>
            </details>
            
            <div style="margin-top: var(--spacing-2xl); padding-top: var(--spacing-lg); border-top: 1px solid var(--border);">
                <p style="font-size: var(--text-sm); color: var(--text-muted); margin-bottom: var(--spacing-md);">Need more help?</p>
                <a href="mailto:support@example.com" style="color: var(--accent); text-decoration: none; display: inline-flex; align-items: center; gap: var(--spacing-sm);">
                    <i class="fas fa-envelope"></i>Contact Support
                </a>
            </div>
            </div>
        </div>
    </div>
    
    <script>
        function goBack() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = '/';
            }
        }
        
        function copyErrorDetails() {
            const errorText = document.querySelector('.error-technical pre')?.textContent || '';
            if (navigator.clipboard) {
                navigator.clipboard.writeText(errorText).then(() => {
                    showToast('Error details copied to clipboard', 'success');
                });
            }
        }
    </script>
    
    <!-- Toast Container -->
    <div id="toast-container"></div>
    
    <!-- Toast Notification Script -->
    <script src="/static/js/ui.js"></script>
    <script>
        function showToast(message, type = 'info', duration = 5000) {
            const container = document.getElementById('toast-container');
            if (!container) return;
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const iconMap = {
                success: 'fa-check-circle',
                error: 'fa-exclamation-circle',
                info: 'fa-info-circle'
            };
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${iconMap[type] || iconMap.info}"></i>
                </div>
                <div class="toast-content">${message}</div>
                <button class="toast-close" onclick="removeToast(this.parentElement)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                removeToast(toast);
            }, duration);
        }
        
        function removeToast(toast) {
            if (!toast) return;
            toast.classList.add('removing');
            setTimeout(() => {
                toast.remove();
            }, 300);
        }
    </script>
</body>
</html>
